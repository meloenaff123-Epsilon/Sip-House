<script>
document.addEventListener("DOMContentLoaded", function(){

  // Header scroll effect
  window.addEventListener("scroll", function(){
    document.querySelector("header")
      .classList.toggle("scrolled", window.scrollY > 50);
  });

  // Counter animation
  function isInViewport(el) {
    const rect = el.getBoundingClientRect();
    return rect.top < window.innerHeight && rect.bottom >= 0;
  }

  function animateCounters() {
    const counters = document.querySelectorAll('.count');

    counters.forEach(counter => {
      if (!counter.classList.contains('started') && isInViewport(counter)) {

        counter.classList.add('started');

        const target = +counter.getAttribute('data-target');
        let count = 0;
        const speed = 200;

        function update(){
          count += target / speed;
          if(count < target){
            counter.innerText = Math.ceil(count);
            requestAnimationFrame(update);
          } else {
            counter.innerText = target;
          }
        }

        update();
      }
    });
  }

  window.addEventListener('scroll', animateCounters);
  animateCounters();

});

// Calculator
function calculateCost(){
  let size = parseFloat(document.getElementById("size").value);
  let floor = parseFloat(document.getElementById("floor").value);
  let finish = parseFloat(document.getElementById("finish").value);

  if(!size || size < 30){
    alert("Хэмжээг зөв оруулна уу (30м2-с дээш).");
    return;
  }

  let basePricePerM2;

  if(size <= 80){
    basePricePerM2 = 1300000;
  } else if(size <= 120){
    basePricePerM2 = 1200000;
  } else {
    basePricePerM2 = 1100000;
  }

  let total = size * basePricePerM2 * floor * finish;

  let resultBox = document.getElementById("result");

  resultBox.innerHTML =
    "Ойролцоох үнэ: <strong>" +
    total.toLocaleString() +
    "₮</strong><br><small>Нарийвчилсан үнийн санал авах бол доорх form-оор холбогдоно уу.</small>";

}
</script>
